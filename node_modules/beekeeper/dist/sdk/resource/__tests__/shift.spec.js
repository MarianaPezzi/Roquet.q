"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const url_1 = __importDefault(require("url"));
const querystring_1 = __importDefault(require("querystring"));
const shift_1 = require("../shift");
const mockedFetch = window.fetch;
describe('ShiftResource', () => {
    const baseURL = 'https://tenant.beekeeper.io';
    let resource;
    beforeEach(() => {
        resource = new shift_1.ShiftResourceImpl(baseURL);
    });
    afterEach(() => {
        mockedFetch.mockClear();
    });
    describe('.list()', () => {
        test('calls /api/2/shifts endpoint with filter as query', async () => {
            const start = '2020-11-18T18:02:56.329Z';
            const end = '2020-11-19T18:02:56.329Z';
            const filter = new shift_1.ShiftsFilter();
            filter.start = new Date(start);
            filter.end = new Date(end);
            await resource.list(filter);
            expect(mockedFetch).toHaveBeenCalled();
            const [call] = mockedFetch.mock.calls;
            const calledUrl = url_1.default.parse(call[0].toString());
            const queryObj = querystring_1.default.parse(calledUrl.query);
            expect(queryObj).toEqual(expect.objectContaining({
                start: start,
                end: end,
            }));
        });
    });
});
